# IsoLens UI Component Plan

This document outlines the planned UI components for each sidebar page in the IsoLens interface. The planning is based on the actual system architecture and what functionality the malware sandbox provides.

> **Note:** This is a planning document only. No implementation is included.

---

## Architecture Reference

Before diving into components, here's how the UI relates to backend modules:

| UI Page | Primary Backend Modules |
|---------|------------------------|
| Scan | `gateway/`, `controller/` |
| Reports | `modules/`, `threatintelligence/`, `storage/` |
| Scan History | `storage/`, `gateway/` |
| Sandbox | `controller/`, `agent/` |
| Settings | `gateway/` (config endpoints) |
| Help & Support | Static content |

---

## 1. Scan Page (`/scan`)

### Purpose
The primary entry point where users upload suspicious files for analysis. This page handles file submission and initiates the sandbox analysis workflow.

### Planned Components

| Component | Description |
|-----------|-------------|
| `FileUploadDropzone` | Drag-and-drop area for file upload with click-to-browse fallback. Accepts executable files (.exe, .dll, .bat, .ps1, etc.). Shows file validation feedback. |
| `UploadProgressIndicator` | Displays upload progress, file transfer to shared folder status, and submission confirmation. |
| `QuickScanStatus` | Shows the status of the most recent scan (if any is running). Displays: file name, current phase (uploading, executing, collecting, analyzing), elapsed time. |
| `SupportedFileTypes` | Info card listing accepted file formats and size limits. Helps users understand what can be analyzed. |
| `ScanOptionsPanel` | Optional panel for advanced users to configure: analysis timeout duration, whether to capture screenshots, network monitoring toggle. |

### Data Flow
```
User uploads file → FileUploadDropzone → gateway API → controller → VM execution
```

---

## 2. Reports Page (`/reports`)

### Purpose
Displays detailed behavioral analysis reports generated after sandbox execution. Shows IOCs, risk scores, process activity, and AI-generated threat summaries.

### Planned Components

| Component | Description |
|-----------|-------------|
| `ReportList` | Paginated list/grid of all generated reports. Shows: file name, submission date, risk level badge, quick actions (view, download, delete). |
| `ReportDetailView` | Full report view containing all sub-components below. Opened when user clicks a report. |
| `RiskScoreCard` | Visual indicator of overall threat level (Safe/Low/Medium/High/Critical). Displays numeric score with color coding. |
| `ExecutionSummary` | Overview card: execution duration, exit code, sandbox VM used, analysis timestamp. |
| `ProcessActivityTimeline` | Chronological list of processes spawned during execution. Data from `observer/` and `agent/` collectors. Shows: process name, PID, parent PID, command line, timestamps. |
| `FileSystemActivity` | Table of file operations: files created, modified, deleted. Parsed from Procmon/Sysmon data via `modules/`. |
| `RegistryActivity` | Table of registry key operations: keys created, modified, deleted. Important for detecting persistence mechanisms. |
| `NetworkActivityLog` | Table of network connections attempted: destination IP/domain, port, protocol, bytes sent/received. Data from network capture. |
| `IOCTable` | Extracted Indicators of Compromise: suspicious IPs, domains, file hashes, mutex names, registry paths. Generated by `modules/` parsing layer. |
| `ThreatSummaryCard` | AI-generated natural language summary of the analysis. Produced by `threatintelligence/` module. Explains what the sample did in plain English. |
| `ScreenshotGallery` | Grid of screenshots captured during execution (if enabled). Helps visualize GUI-based malware behavior. |
| `ReportExportButtons` | Download options: PDF report, JSON data, CSV IOCs. |

### Data Flow
```
storage/ → gateway API → ReportList → ReportDetailView → sub-components
```

---

## 3. Scan History Page (`/scan-history`)

### Purpose
Provides a searchable log of all past scan submissions, allowing users to track analysis history and revisit previous results.

### Planned Components

| Component | Description |
|-----------|-------------|
| `ScanHistoryTable` | Paginated table with columns: File Name, SHA256 (truncated), Submission Date, Status (Pending/Running/Completed/Failed), Risk Level, Actions. |
| `HistorySearchBar` | Text search for file names and hash lookups. |
| `HistoryFilters` | Filter dropdowns: date range, status, risk level. Helps narrow down large history lists. |
| `StatusBadge` | Reusable component showing scan status with appropriate color: gray (pending), blue (running), green (completed), red (failed). |
| `RiskLevelBadge` | Reusable component showing risk level with color gradient: green (safe) to red (critical). |
| `PaginationControls` | Page navigation for large result sets. |
| `BulkActions` | Checkbox selection with bulk delete or bulk export options. |

### Data Flow
```
storage/ (scan records) → gateway API → ScanHistoryTable
```

---

## 4. Sandbox Page (`/sandbox`)

### Purpose
Provides visibility and control over the sandbox VM. Users can monitor VM status, view resource usage, and manually control the sandbox environment.

### Planned Components

| Component | Description |
|-----------|-------------|
| `VMStatusCard` | Large status indicator showing current VM state: Running, Stopped, Paused, Restoring Snapshot. Includes uptime if running. |
| `VMControlPanel` | Action buttons to control VM: Start, Stop, Pause, Restore Snapshot. Communicates with `controller/` VBoxManage wrapper. |
| `AgentConnectionStatus` | Shows whether the guest agent (`isolens_agent.py`) is reachable on the host-only network. Displays: connected/disconnected, last heartbeat time. |
| `SharedFolderStatus` | Indicates if `SandboxShare/` is mounted and accessible. Shows path and read/write status. |
| `CurrentAnalysisCard` | If a sample is currently being analyzed, shows: file name, current phase, progress indicator, elapsed time. |
| `VMInfoCard` | Static info about the sandbox VM: VM name, OS (Windows 7), allocated RAM, network adapter config. Data from `controller/` VM info queries. |
| `SnapshotSelector` | Dropdown to select which clean snapshot to restore. Lists available VirtualBox snapshots. |
| `QuickLogs` | Collapsible section showing recent controller logs or agent responses. Useful for debugging. |

### Data Flow
```
controller/ (VBoxManage) → gateway API → VMStatusCard, VMControlPanel
agent/ (HTTP API) → gateway API → AgentConnectionStatus
```

---

## 5. Settings Page (`/settings`)

### Purpose
Configuration interface for system parameters, analysis options, and user preferences.

### Planned Components

| Component | Description |
|-----------|-------------|
| `AnalysisSettingsForm` | Form to configure: default analysis timeout (seconds), screenshot capture interval, network capture toggle, auto-restore snapshot toggle. |
| `VMConfigurationPanel` | Display (read-only or editable) VM settings: VM name, snapshot name, shared folder path, host-only adapter name. |
| `GatewayConfigPanel` | API configuration: gateway port, allowed origins, rate limiting. Primarily for admin use. |
| `StorageSettingsPanel` | Configure storage paths: sample storage location, report output directory, log retention period. |
| `UserPreferencesForm` | UI preferences: theme (if supported), default report view (list/grid), items per page in tables. |
| `SaveSettingsButton` | Persists configuration changes. Shows success/error feedback. |
| `ResetDefaultsButton` | Restores all settings to default values with confirmation dialog. |

### Data Flow
```
Settings forms → gateway API → config file/database
```

---

## 6. Help & Support Page (`/help-support`)

### Purpose
Provides documentation, FAQs, and information about the IsoLens project for users who need assistance.

### Planned Components

| Component | Description |
|-----------|-------------|
| `GettingStartedGuide` | Step-by-step introduction: how to upload a file, interpret reports, understand risk scores. |
| `FAQAccordion` | Expandable FAQ section with common questions: "What files can I scan?", "How long does analysis take?", "What does the risk score mean?" |
| `DocumentationLinks` | Cards linking to detailed documentation: Architecture overview, VM setup guide, API reference. Links to `docs/` files or rendered docs. |
| `AboutSection` | Project information: version, contributors, academic context (S6 Mini Project), GitHub repository link. |
| `TroubleshootingSection` | Common issues and solutions: VM won't start, agent not connecting, scan stuck. |
| `ContactCard` | Contact information or links for reporting issues (GitHub Issues link). |

### Data Flow
```
Static content (no backend API required)
```

---

## Shared/Reusable Components

These components will be used across multiple pages:

| Component | Used In | Description |
|-----------|---------|-------------|
| `StatusBadge` | Reports, History, Sandbox | Colored badge indicating status |
| `RiskLevelBadge` | Reports, History | Colored badge for threat level |
| `LoadingSpinner` | All pages | Displayed during API calls |
| `ErrorAlert` | All pages | Displays error messages from failed operations |
| `ConfirmationDialog` | Settings, History | Modal for confirming destructive actions |
| `EmptyState` | Reports, History | Placeholder when no data exists |
| `Pagination` | Reports, History | Page navigation controls |
| `Card` | All pages | Consistent card container styling |
| `DataTable` | Reports, History | Reusable table with sorting and filtering |

---

## Component-to-Module Mapping

This table shows which backend modules each component depends on:

| Component | Backend Module | API Endpoint (planned) |
|-----------|---------------|------------------------|
| FileUploadDropzone | gateway, controller | `POST /api/scan/upload` |
| QuickScanStatus | controller | `GET /api/scan/status/{id}` |
| ReportList | storage | `GET /api/reports` |
| ReportDetailView | storage, modules | `GET /api/reports/{id}` |
| ThreatSummaryCard | threatintelligence | `GET /api/reports/{id}/summary` |
| VMStatusCard | controller | `GET /api/sandbox/status` |
| VMControlPanel | controller | `POST /api/sandbox/control` |
| AgentConnectionStatus | agent | `GET /api/agent/health` |
| ScanHistoryTable | storage | `GET /api/scans` |

---

## Implementation Priority (Suggested)

For incremental development, consider this order:

1. **Phase 1 - Core Flow**
   - Scan: FileUploadDropzone, UploadProgressIndicator
   - Reports: ReportList, ReportDetailView (basic)
   - Sandbox: VMStatusCard, VMControlPanel

2. **Phase 2 - Detail Views**
   - Reports: ProcessActivityTimeline, NetworkActivityLog, IOCTable
   - Scan History: ScanHistoryTable with filters

3. **Phase 3 - Enhancement**
   - Reports: ThreatSummaryCard, ScreenshotGallery
   - Settings: AnalysisSettingsForm
   - Help: All static components

---

## Notes

- All components should handle loading and error states gracefully
- Mobile responsiveness is secondary but should be considered
- Components should be built with TypeScript for type safety
- Use Tailwind CSS classes consistent with existing UI (violet accent color)
- API integration should use a centralized fetch utility with error handling
